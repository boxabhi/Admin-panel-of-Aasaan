{% extends "console/base.html" %}
{% block content %}
<main class="content">

    <div class="container-fluid p-0">

        <div class="row mb-2 mb-xl-3">
            <div class="col-auto d-none d-sm-block">
                <h3><strong>View Assign Followups</strong></h3>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                        </div>
                        <div class="card-body">



                            <table class="table" id="table_enrollments" class="display">
                                <thead class="thead-white">
                                    <tr>

                                        <th scope="col">S. NO</th>
                                        <th scope="col">Title</th>
                                        <th scope="col"> Assigned by </th>
                                        <th scope="col"> Assigned to</th>
                                        <th scope="col">Followups count</th>
                                        <th scope="col">Completion date</th>
                                        <th scope="col">Days Left</th>
                                        <th scope="col">Date of Assigned</th>
                                        <th scope="col">View followups</th>
                                    </tr>
                                </thead>

                                {% for data in batchfollowupsrecord %}
                                <tbody id="show_batches">
                                    <tr>
                                        <td class="text-center">{{forloop.counter}}</td>
                                        <td class="text-center">{{data.title}}</td>
                                        <td class="text-center">{{data.assigned_by_user.username}}</td>
                                        <td class="text-center"> {{data.assign_to_user.username}}</td>
                                        <td class="text-center">{{data.batch_followups.all.count}}</td>
                                        <td class="text-center">
                                            {{data.completion_date_for_followups|date:'d-M-Y'}}</td>
                                        <td class="text-center">
                                            {% if data.get_days_left == '2'%}
                                            <p class="text-danger"> {{ data.get_days_left }} days</p>
                                            {% else %}
                                            {{ data.get_days_left }} days

                                            {% endif %}

                                            </p>
                                        </td>
                                        <td>{{data.created_at|date:'d-M-Y g:H A'}}</td>
                                        <td class="text-center">
                                            <a target="_blank" href="{% url 'show_assigned_followups'  data.id %} "
                                                class="btn btn-info">View <i class="fas fa-arrow-right"></i></button>
                                        </td>

                                    </tr>
                                </tbody>
                                {% endfor %}
                            </table>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</main>

<div class="modal fade" id="assignFollowups" tabindex="-1" aria-labelledby="assignFollowupsLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Assign Followups</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-3">

                <div class="row">
                    <div class="col-md-12">
                        <label>Select user</label>
                        <select class="form-control" id="assign_to_user">
                            <option>Choose</option>
                            {% for user in users %}
                            <option value="{{user.id}}">{{user.email}}</option>

                            {% endfor %}
                        </select>
                    </div>
                </div>


            </div>
            <div class="modal-footer">
                <button type="button" onclick="assignFollowups()" class="btn btn-warning">Assign</button>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    var nodes = document.querySelectorAll('#days')
    console.log(nodes)

    for (var i = 0; i < nodes.length; i++) {
        var days = 0
        var date = (nodes[i].textContent).split(' ')
        date = date[1].replace('-', '/')

        console.log(date)
        const date1 = new Date();

        var current_date = date1.getDate() + '/' + date1.getMonth() + '/' + date1.getFullYear()
        console.log(current_date)
        const date2 = new Date("31/03/2021")

        console.log(date2 - current_date)

    }
</script>


{% endblock %}